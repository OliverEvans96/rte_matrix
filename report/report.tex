\documentclass[10pt]{article}

\usepackage{graphicx}
\usepackage{amsmath}
\usepackage{gensymb}
\usepackage{mathtools}
\usepackage{etoolbox}
\usepackage{booktabs}
\usepackage[parfill]{parskip}
\usepackage[numbers]{natbib}
\usepackage{float}
\usepackage{graphicx}
\usepackage{geometry}
\usepackage{multicol}
\usepackage{caption}

\newcommand\mgin{0.5in}
\geometry{
	left=\mgin,
	right=\mgin,
	bottom=\mgin,
	top=\mgin
}

% Set path to import figures from
\graphicspath{{../../img/sparsity/}}

% Place converted graphics in current directory
\usepackage[outdir=./]{epstopdf}

% Define multicolumn figure-like environment
% from http://tex.stackexchange.com/questions/12262/multicol-and-figures
\newenvironment{mcfig}
	{\par\medskip\noindent\minipage{\linewidth}}
	{\endminipage\par\medskip}

% Define error function for math mode
\newcommand{\erf}{\mbox{erf}}
% Sign function
\newcommand{\sign}{\mbox{sign}}
% Natural numbers
\newcommand\N{\mathbb{N}}
% Real numbers
\newcommand\R{\mathbb{R}}
% Complex numbers
\newcommand\C{\mathbb{C}}
% Curly B for basis
\newcommand\BB{\mathcal{B}}
% Curly R for range (not real numbers)
\newcommand\RR{\mathcal{R}}
% Curly N for null space
\newcommand\NN{\mathcal{N}}
% Norm
\newcommand\norm[1]{\left\lVert #1 \right\rVert}
% Uniform Norm
\newcommand\unorm[1]{\left\lVert #1 \right\rVert_\infty}
% Inner Product
\newcommand\ip[1]{\left\langle #1 \right\rangle}
% Absolute value
\newcommand\abs[1]{\left| #1 \right|}
% Complex Conjugate
\newcommand\conj\overline
% Partial derivative
\newcommand\pd[2]{\frac{\partial #1}{\partial #2}}
% Disable paragraph indentation
\setlength{\parindent}{0pt}
% End of proof
\newcommand\qed{\hfill$\blacksquare$\hspace{0.5in}}

% Number this equation
\newcommand\eqnum{\addtocounter{equation}{1}\tag{\theequation}}

% arara: pdflatex
% arara: bibtex
% arara: pdflatex
% arara: pdflatex
\begin{document}

%%fakesection Title
\null

\thispagestyle{empty}
\addtocounter{page}{-1}

\begin{center}
    \begin{sffamily}
	\begin{bfseries}
	    \null
	    \vfill
		\Huge{Survey of Solution Techniques for Linear Systems from Finite Difference Methods in 2D Numerical Radiative Transfer}

	    \vspace{20pt}
	    \LARGE{Project Summary} \\
		\LARGE{ASSETs to Serve Humanity NSF REU 2016} \\
	    \vspace{20pt}
    \begin{Large}
		Oliver Evans \\
		Fred Weiss \\
		Christopher Parker \\
		Emmanuel Arkoh \\[1em]

		Dr. Malena Espa\~nol \\
	\vspace{20pt}
	\today
    \end{Large}
	\end{bfseries}
    \end{sffamily}
    \vspace{30pt}

    \null
    \vfill
    \vfill
    \null
\end{center}
\pagebreak


% Increase table cell height (not for header)
\renewcommand{\arraystretch}{1.5}

\begin{multicols}{2}

\section{Introduction}
We use monochromatic radiative transfer in order to model the light field in an aqueous environment populated by vegetation.
The vegetation (kelp) is modeled by a spatial probability distribution, which we assume to be given.
The two quantities we seek to compute are \textit{radiance} and \textit{irradiance}.
Radiance is the intensity of light in at a particular point in a particular direction, while irradiance is the total light intensity at a point in space, integrated over all angles.
The Radiative Transfer Equation is an integro-partial differential equation for radiance, which has been used primarily in stellar astrophysics; it's application to marine biology is fairly recent \citep{mobley_radiative_2001}.

We study various methods for solving the system of linear equations resulting from discretizing the Radiative Transfer Equation.
In particular, we consider direct methods, stationary iterative methods, and nonstationary iterative methods.
Numerical experiments are performed using Python's \texttt{scipy.sparse} \citep{jones_scipy:_2001} package for sparse linear algebra.
\texttt{IPython} \citep{perez_ipython:_2007} was used for interactive numerical experimentation.

Among those implemented, the nonstationary LGMRES \citep{baker_technique_2005} algorithm is the only algorithm determined to be suitable for this application without further work.
We discuss limitations and potential improvements, including preconditioning, alternative discretization, and reformulation of the RTE.

\subsection{Radiative Transfer}
Let $n$ be the number of spatial dimensions for the problem (i.e., 2 or 3).
Let $x \in \RR^n$.
Let $\Omega$ be the unit sphere in $\RR^n$.
Let $\omega \in \Omega$ be a unit vector in $\RR^n$.
Let $L(x,\omega)$ denote \textit{radiance} position $x$ in the direction $\omega$.
Let $I(x)$ denote \textit{irradiance} at position $x$.
Let $P_k(x)$ be the probability density of kelp at position $x$.
Let $a(x)$ and $b(x)$ denote the absorption and scattering coefficients respectively of the medium, which are both functions of $P_k$.
Let $\beta(\Delta\theta)$ denote the normalized \textit{volume scattering function} or \textit{phase function}, which defines the probability of light scattering at an angle $\Delta\theta$ from it's initial direction in a scattering event.

Then, the Monochromatic Radiative Transfer Equation (RTE) is
\begin{equation}
	\tag{RTE}
	\label{eq:rte}
	\begin{aligned}
		\omega \cdot \nabla_x L(x,\omega) &= -(a(x) + b(x)) L(x,\omega) \\
		&\qquad + b \int_\Omega \beta(\omega \cdot \omega') L(x,\omega')\, d\omega'
	\end{aligned}
\end{equation}

Note that in 2 spatial dimensions, this is a 3-dimensional problem ($x,y,\theta$).
Likewise, in 3 spatial dimensions, it is a 5-dimensional problem ($x,y,z,\theta,\phi$).

In this paper, we consider only the 2-dimensional problem, with the hope that sufficiently robust solution techniques for the 2-dimensional problem will be effective in the solution of the 3-dimensional problem, as well.

\subsection{2D Problem}
\label{sec:2d}
We use the downward-pointing coordinate system shown in figure \ref{fig:coords}, measuring $\theta \in [0,2\pi)$ from the positive $x$ axis towards the positive $y$ axis.
Further, we assume that the problem is given on the rescaled spatial domain $[0,1) \times [0,1)$, where $y=0$ is the air-water interface, and $y$ measures depth from the surface.

\begin{figure}[H]
	\centering
	\includegraphics[width=2in]{2d_coords}
	\caption{2D coordinate system}
	\label{fig:coords}
\end{figure}

The 2-dimensional form of \eqref{eq:rte} is given by
\begin{equation}
	\begin{aligned}
		\pd{L}{x} \cos\theta + \pd{L}{y} \sin\theta
		&= -(a+b)L(x,y,\theta) \\
		&+ b\int_0^{2\pi} \beta(\abs{\theta-\theta'})\,d\theta',
	\end{aligned}
	\label{eq:rte2d}
\end{equation}

where $\abs{\theta-\theta'}$ measures the smallest angular difference between $]thet$ and $\theta'$ considering periodicity.

Note that in Cartesian coordinates, there are only spatial, not angular derivatives in the gradient.
In other coordinate systems, this is generally not the case.
	
\subsection{Boundary Conditions}
We assume that the downwelling light from the surface is known, and is defined to be uniform in space by the Dirichlet boundary condition 
\begin{equation}
	L(x,0,\theta) = f(\theta), \quad \mbox{for} \quad \theta \in [0,\pi).
	\label{eq:surf_bc}
\end{equation}

Note that we cannot apply the same idea to upwelling light at the surface, as it cannot be specified from information about the atmospheric light field.
Therefore, we apply the PDE at $y=0$ for $\theta \in [\pi,2\pi)$.

At $y=1$, we assume no upwelling light.
That is,
\begin{equation}
	L(x,0,\theta) = 0, \quad \mbox{for} \quad \theta \in [\pi,2\pi).
	\label{eq:bottom_bc}
\end{equation}

As with the upper $y$-boundary, we apply the PDE for $\theta \in [0,\pi)$ so as not to prohibit downwelling light.

In the horizontal direction, we assume periodic boundary conditions.
Assuming that a single discrete group of plants is being simulated, adjusting the width of the domain effectively modifies the spacing between adjacent groups of plants.

\section{System of Linear Equations}

\subsection{Discretization}
In order to solve \eqref{eq:rte2d} numerically, we discretize the spatial derivatives using 2nd order finite difference approximations, and we discretize the integral according to the Legendre-Gauss quadrature, as described in chapter 2 of \citet{chandrasekhar_radiative_1960}.
With this in mind, in order to create a spatial-angular grid with $n_x,n_y$, and $n_\theta$ discrete values for $x, y$, and $\theta$ respectively, we use a uniform square spatial discretization with spacing $dx, dy$, and a non-uniform angular discretization according to the roots of the Legendre Polynomial of degree $n_\theta$, denoted $P_{n_\theta}(\theta)$.
In each variable, we discard the uppermost grid point, as indicated by the half-open intervals in the previous sections.

Then, we have the grid
\begin{align}
	x_i &= (i-1)\,dx, &\quad i=1,\ldots,n_x \\
	y_j &= (j-1)\,dy, &\quad j=1,\ldots,n_y \\
	\theta_k \,\, \mbox{s.t.}\,\, 
	&P_{n_\theta}(\theta_k/2\pi) = 0, &\quad k=1,\ldots,n_\theta
\end{align}

In the same notational vein, let \\[-1em]
\begin{align}
	L_{ij}^k &= L(x_i,y_j,\theta_k), \\
	\beta_{kl} &= \beta(\abs{\theta_k-\theta_l}), \\
	a_{ij} &= a(x,y) \\
	b_{ij} &= b(x,y)
\end{align}

where $\abs{\cdot}$ is periodic as in \eqref{eq:rte2d}.

For the spatial interior of the domain, we use the 2nd order central difference formula (CD2) to approximate the derivatives, which is
\begin{equation}
	\tag{CD2}
	f'(x) = \frac{f(x+dx)-f(x-dx)}{2dx} + \mathcal{O}(dx^3).
\end{equation}

When applying the PDE on the upper or lower boundary, we use the forward and backward difference (FD2 and BD2) formulas respectively.
Omitting $\mathcal{O}(dx^3)$, we have
\begin{equation}
	\tag{FD2}
	\label{eq:FD2}
	f'(x) = \frac{-3f(x)+2f(x+dx)-f(x+2dx)}{2dx}
\end{equation}
\begin{equation}
	\tag{BD2}
	\label{eq:BD2}
	f'(x) = \frac{3f(x)-2f(x-dx)+f(x-2dx)}{2dx}
\end{equation}

As for the angular integral, we substitute a weighted finite sum of the function evaluated at the angular grid points.
For each $k$, let $a_k$ be the appropriate Legendre-Gauss weight according to \citet[Chapter 2]{chandrasekhar_radiative_1960}.
Then, applying the change of variables theorem to transform from the standard quadrature interval $[0,1]$ to the correct angular interval $[0,2\pi]$, we have
\begin{equation}
	\tag{LG}
	\int_0^{2\pi} f(\theta)\,d\theta \approx \pi\sum_{k=1}^n a_k f(\theta_k)
\end{equation}

\subsection{Difference Equation}
Given the above discrete approximations, the difference equation for \eqref{eq:rte} is
\begin{align}
	\label{eq:diffeq}
	\begin{split}
	&\quad\frac{1}{2dx}\left(L_{i+1,j}^k - L_{i-1,j}^k\right) \cos\theta_k 
	- \pi b \sum_{\substack{l=1\\ l\neq k}}^{n_\theta} a_l\beta_{kl}L_{ij}^l \\
	&+ \frac{1}{2dy}\left(L_{i,j+1}^k - L_{i,j+1}^k\right) \sin\theta_k 
	- (a_{ij} + b_{ij})L_{ij}^k
	=0
	\end{split}
\end{align}

Similarly, we discretize using \eqref{eq:FD2} and \eqref{eq:BD2} at the boundaries.

\subsection{Structure of Linear System}
For each $i,j,k$, we have a distinct equation with $4+n_\theta$ variables.
This corresponds to a sparse matrix equation $Ax=b$, each row having $4+n_\theta$ nonzero entries.
Note that $b$ is zero at each row except those which correspond to boundary conditions in $y$.

Each element in $x$ and $b$ correspond to a particular triple $(i,j,k)$, as are each row and column of the coefficient matrix, $A$.
In some sense, when we create this linear system, we are unwrapping a 3-dimensional quantity (radiance) into a 1-dimensional vector (the solution, $x$).
Different orders in which the equations are listed can be chosen to generate equivalent systems, so long as the ordering is consistent in $A,b$, and $x$.

The most obvious way to order the equations is to do so via a triple \texttt{for} loop, which has the effect of creating blocks in the matrix corresponding to planes in $(x,y,\theta)$ space.
For example, if the equations are ordered such that the outer \texttt{for} loop is over $x$, and the inner two are over $y$ and $\theta$, then the first $(n_y n_\theta)$ rows of the matrix correspond to the equations for $i=1$.

By switching the order of the \texttt{for} loops, we can generate 6 equivalent matrix systems, each of which can be identified with a permutation of the triple $(0,1,2)$, where 0 corresponds to $x$, 1 corresponds to $y$, and 2 corresponds to $\theta$, and the order of the numbers indicates the order in which the loops were nested, from outer to inner.



\subsection{Diagonal dominance}

\pagebreak

\subsection{Sparsity Plots}

\newcommand{\spwidth}{2.5in}
\newcommand{\spmgin}{.1in}

\begin{center}
\noindent
\begin{minipage}[t]{.5\textwidth}%
\begin{figure}[H]
	\centering
	\includegraphics[width=\spwidth]{../img/sparsity/int_small_6x6x6_012.eps}
	\caption{Sparsity plot: 6x6x6, ordering 012 }
\end{figure}
\vspace{\spmgin}
\begin{figure}[H]
	\centering
	\includegraphics[width=\spwidth]{../img/sparsity/int_small_6x6x6_021.eps}
	\caption{Sparsity plot: 6x6x6, ordering 021 }
\end{figure}
\vspace{\spmgin}
\begin{figure}[H]
	\centering
	\includegraphics[width=\spwidth]{../img/sparsity/int_small_6x6x6_102.eps}
	\caption{Sparsity plot: 6x6x6, ordering 102 }
\end{figure}
\end{minipage}%
\begin{minipage}[t]{.5\textwidth}%
\begin{figure}[H]
	\centering
	\includegraphics[width=\spwidth]{../img/sparsity/int_small_6x6x6_120.eps}
	\caption{Sparsity plot: 6x6x6, ordering 120 }
\end{figure}
\vspace{\spmgin}
\begin{figure}[H]
	\centering
	\includegraphics[width=\spwidth]{../img/sparsity/int_small_6x6x6_201.eps}
	\caption{Sparsity plot: 6x6x6, ordering 201 }
\end{figure}
\vspace{\spmgin}
\begin{figure}[H]
	\centering
	\includegraphics[width=\spwidth]{../img/sparsity/int_small_6x6x6_210.eps}
	\caption{Sparsity plot: 6x6x6, ordering 210 }
\end{figure}
\end{minipage}%
\end{center}
\pagebreak

\subsection{Matrix Properties}
\subsubsection{Diagonal Dominance}
\subsubsection{Spectral Radius}

\section{Direct Methods}
\subsection{Factorizations}
\subsection{Software Packages}

\section{Stationary Iterative Methods}
\subsection{Fixed-Point Iteration}
\subsection{Convergence and Preconditioning}

\section{Nonstationary Iterative Methods}
\subsection{Krylov Subspace Methods}
\subsection{Convergence and Preconditioning}

\section{Numerical Results}

\section{Conclusions}

\nocite{*}
\bibliographystyle{abbrvnat}
\bibliography{rte_matrix_report}
\end{multicols}
>>>>>>> Stashed changes
\end{document}


